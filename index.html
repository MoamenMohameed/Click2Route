<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
<link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine/dist/leaflet-routing-machine.css" />

<title>Click2Route</title>

<style>
#map {
    height: 100vh;
}
</style>
</head>
<body>

<div id="map"></div>



<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
<script src="https://unpkg.com/leaflet-routing-machine/dist/leaflet-routing-machine.js"></script>

<script>
const map = L.map("map").setView([30.0444, 31.2357], 13);

L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
attribution: "Â© OpenStreetMap contributors",
maxZoom: 20,
}).addTo(map);

let points = [];
let routingControl = null;
let markers = [];

map.on("click", (e) => {

if (points.length === 2) {
markers.forEach((m) => map.removeLayer(m));
markers = [];

if (routingControl) {
    map.removeControl(routingControl);
    routingControl = null;
}

points = [];
}


markers.push(L.marker(e.latlng).addTo(map));
points.push(e.latlng);


if (points.length === 2) {
routingControl = L.Routing.control({
    waypoints: points,
    routeWhileDragging: false,
    lineOptions: {
    styles: [{ color: "blue", weight: 4 }],
    },
    createMarker: () => null,
}).addTo(map);
}
});


</script>
</body>
</html>